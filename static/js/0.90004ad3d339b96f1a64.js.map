{"version":3,"sources":["webpack:///src/components/music-list/music-list.vue","webpack:///./src/components/music-list/music-list.vue?1c62","webpack:///./src/components/music-list/music-list.vue"],"names":["transform","Object","dom","backdrop","music_list","mixins","mixin","components","Scroll","scroll_scroll","SongList","song_list","Loading","loading","props","title","type","String","default","bgImage","rank","Boolean","songs","Array","data","scrollY","watch","newY","layer","this","$refs","maxTranslateY","imageHeight","translateY","Math","max","style","image","play","TOP_HEIGHT","display","scale","abs","percent","blur","min","filter","mounted","clientHeight","scroll","$el","top","computed","bgStyle","methods","extends_default","back","$router","scrollList","pos","y","selectSongItem","song","index","selectPlay","list","clickRandomPlayAll","util","$store","commit","randomPlayAll","handlePlayList","bottom","length","refresh","vuex_esm","music_list_music_list","render","_vm","_h","$createElement","_c","_self","staticClass","on","click","_v","_s","ref","_e","attrs","probe-type","listen-scroll","select_song","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/0.90004ad3d339b96f1a64.js","sourcesContent":["<template>\r\n  <div class=\"music-list\">\r\n    <div class=\"back\" @click=\"back\">\r\n      <i class=\"icon-back\"></i>\r\n    </div>\r\n    <h1 class=\"title\">{{ title }}</h1>\r\n    <div class=\"bg-image\" :style=\"bgStyle\" ref=\"image\">\r\n      <div class=\"filter\" ref=\"filter\"></div>\r\n      <div class=\"play-wrapper\">\r\n        <div class=\"play\" ref=\"play\" v-if=\"songs.length>0\" @click=\"clickRandomPlayAll\">\r\n          <span class=\"icon-play\"></span>\r\n          <span class=\"text\">随机播放全部</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"scroll-layer\" ref=\"layer\"></div>\r\n    <scroll @scroll=\"scrollList\" :probe-type=\"3\"\r\n            :listen-scroll=\"true\" :data=\"songs\"\r\n            class=\"scroll\" ref=\"scroll\">\r\n      <div class=\"song-list-wrapper\">\r\n        <song-list @select_song=\"selectSongItem\" :songs=\"songs\" :rank=\"rank\"></song-list>\r\n      </div>\r\n      <div class=\"loading-container\" v-if=\"!songs.length\">\r\n        <loading></loading>\r\n      </div>\r\n    </scroll>\r\n  </div>\r\n</template>\r\n\r\n<script type=\"text/ecmascript-6\">\r\n  import Scroll from 'base/scroll/scroll';\r\n  import SongList from 'base/song-list/song-list';\r\n  import Loading from 'base/loading/loading';\r\n  import { prefixStyle } from 'common/js/dom';\r\n  import { mapActions } from 'vuex';\r\n  import { playListMixin } from 'common/js/mixin';\r\n  import { requestFullScreen } from 'common/js/util';\r\n\r\n  // CSS属性\r\n  const transform = prefixStyle('transform');\r\n  const backdrop = prefixStyle('backdrop-filter');\r\n  // 标题的高度\r\n  const TOP_HEIGHT = 40;\r\n\r\n  export default {\r\n    mixins: [playListMixin],\r\n    components: {\r\n      Scroll, SongList, Loading\r\n    },\r\n    props: {\r\n      title: {\r\n        type: String,\r\n        default: ''\r\n      },\r\n      bgImage: {\r\n        type: String,\r\n        default: ''\r\n      },\r\n      rank: {\r\n        type: Boolean,\r\n        default: false\r\n      },\r\n      songs: {\r\n        type: Array,\r\n        default: null\r\n      }\r\n    },\r\n    data () {\r\n      return {\r\n        scrollY: 0\r\n      };\r\n    },\r\n    watch: {\r\n      scrollY (newY) {\r\n        let layer = this.$refs.layer;\r\n        let maxTranslateY = (this.imageHeight - TOP_HEIGHT) / -1;\r\n        let translateY = Math.max(maxTranslateY, newY);\r\n        layer.style[transform] = `translate3d(0,${translateY}px,0)`;\r\n        // 修改图片的层级和高度\r\n        let image = this.$refs.image;\r\n        let play = this.$refs.play;\r\n        if (maxTranslateY > newY) {\r\n          image.style['z-index'] = 10;\r\n          image.style['padding-top'] = 0;\r\n          image.style['height'] = `${TOP_HEIGHT}px`;\r\n          play.style.display = 'none';\r\n        } else {\r\n          image.style['z-index'] = null;\r\n          image.style['padding-top'] = null;\r\n          image.style['height'] = null;\r\n          play.style.display = '';\r\n        }\r\n        if (newY > 0) {\r\n          // 下拉放大图片\r\n          let scale = 1 + Math.abs(newY / this.imageHeight);\r\n          this.$refs.image.style[transform] = `scale(${scale})`;\r\n        } else {\r\n          // 上推背景模糊\r\n          let percent = Math.abs(newY / this.imageHeight);\r\n          let blur = Math.min(20, percent * 20);\r\n          this.$refs.filter.style[backdrop] = `blur(${blur}px)`;\r\n        }\r\n      }\r\n    },\r\n    mounted () {\r\n      // 顶部图片的高度\r\n      this.imageHeight = this.$refs.image.clientHeight;\r\n      this.$refs.scroll.$el.style.top = `${this.imageHeight}px`;\r\n      this.$refs.layer.style.top = `${this.imageHeight}px`;\r\n    },\r\n    computed: {\r\n      bgStyle () {\r\n        return `background-image:url(${this.bgImage})`;\r\n      }\r\n    },\r\n    methods: {\r\n      back () {\r\n        this.$router.back();\r\n      },\r\n      scrollList (pos) {\r\n        this.scrollY = pos.y;\r\n      },\r\n      selectSongItem (song, index) {\r\n        this.selectPlay({\r\n          list: this.songs,\r\n          index\r\n        });\r\n      },\r\n      clickRandomPlayAll () {\r\n        // 全屏补丁\r\n        requestFullScreen();\r\n        this.$store.commit('SET_SCREEN_STATE', true);\r\n        this.randomPlayAll({\r\n          list: this.songs\r\n        });\r\n      },\r\n      // 解决播放器遮挡列表的问题\r\n      handlePlayList (list) {\r\n        let bottom = list.length > 0 ? '60px' : 0;\r\n        this.$refs.scroll.$el.style.bottom = bottom;\r\n        this.$refs.scroll.refresh();\r\n      },\r\n      ...mapActions([\r\n        'selectPlay',\r\n        'randomPlayAll'\r\n      ])\r\n    }\r\n  };\r\n</script>\r\n\r\n<style lang=\"stylus\" rel=\"stylesheet/stylus\">\r\n  @import \"~common/stylus/variable\";\r\n\r\n  .music-list\r\n    position: fixed\r\n    z-index: 100\r\n    top: 0\r\n    left: 0\r\n    bottom: 0\r\n    right: 0\r\n    background: $color-background\r\n    .back\r\n      position: absolute\r\n      top: 0\r\n      left: 6px\r\n      z-index: 50\r\n      .icon-back\r\n        display: block\r\n        padding: 10px\r\n        font-style: $font-size-large-x\r\n        color: $color-theme\r\n\r\n    .title\r\n      position: absolute\r\n      top: 0\r\n      left: 10%\r\n      z-index: 40\r\n      width: 80%\r\n      no-wrap()\r\n      text-align: center\r\n      line-height: 40px\r\n      font-size: $font-size-large\r\n      color: $color-text\r\n    .bg-image\r\n      position: relative\r\n      width: 100%\r\n      height: 0\r\n      padding-top: 70%\r\n      transform-origin: top\r\n      background-size: cover\r\n      .filter\r\n        position: absolute\r\n        top: 0\r\n        left: 0\r\n        width: 100%\r\n        height: 100%\r\n        background: rgba(7, 17, 27, 0.4)\r\n\r\n      .play-wrapper\r\n        position: absolute\r\n        bottom: 20px\r\n        width: 100%\r\n        .play\r\n          box-sizing: border-box\r\n          width: 135px\r\n          padding: 7px 0\r\n          margin: 0 auto\r\n          text-align: center\r\n          border: 1px solid $color-theme\r\n          color: $color-theme\r\n          border-radius: 100px\r\n          font-size: 0\r\n          .icon-play\r\n            display: inline-block\r\n            vertical-align: middle\r\n            margin-right: 6px\r\n            font-size: $font-size-medium-x\r\n          .text\r\n            display: inline-block\r\n            vertical-align: middle\r\n            font-size: $font-size-small\r\n    .scroll-layer\r\n      position: fixed\r\n      top: 0\r\n      bottom: 0\r\n      width: 100%\r\n      height: 100%\r\n      background: $color-background\r\n    .scroll\r\n      position: fixed\r\n      top: 0\r\n      bottom: 0\r\n      width: 100%\r\n      .song-list-wrapper\r\n        padding: 20px 30px\r\n      .loading-container\r\n        width: 100%\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/music-list/music-list.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"music-list\"},[_c('div',{staticClass:\"back\",on:{\"click\":_vm.back}},[_c('i',{staticClass:\"icon-back\"})]),_vm._v(\" \"),_c('h1',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.title))]),_vm._v(\" \"),_c('div',{ref:\"image\",staticClass:\"bg-image\",style:(_vm.bgStyle)},[_c('div',{ref:\"filter\",staticClass:\"filter\"}),_vm._v(\" \"),_c('div',{staticClass:\"play-wrapper\"},[(_vm.songs.length>0)?_c('div',{ref:\"play\",staticClass:\"play\",on:{\"click\":_vm.clickRandomPlayAll}},[_c('span',{staticClass:\"icon-play\"}),_vm._v(\" \"),_c('span',{staticClass:\"text\"},[_vm._v(\"随机播放全部\")])]):_vm._e()])]),_vm._v(\" \"),_c('div',{ref:\"layer\",staticClass:\"scroll-layer\"}),_vm._v(\" \"),_c('scroll',{ref:\"scroll\",staticClass:\"scroll\",attrs:{\"probe-type\":3,\"listen-scroll\":true,\"data\":_vm.songs},on:{\"scroll\":_vm.scrollList}},[_c('div',{staticClass:\"song-list-wrapper\"},[_c('song-list',{attrs:{\"songs\":_vm.songs,\"rank\":_vm.rank},on:{\"select_song\":_vm.selectSongItem}})],1),_vm._v(\" \"),(!_vm.songs.length)?_c('div',{staticClass:\"loading-container\"},[_c('loading')],1):_vm._e()])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-56c5e872\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/components/music-list/music-list.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-56c5e872\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./music-list.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./music-list.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./music-list.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-56c5e872\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./music-list.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/music-list/music-list.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}